# Query Analysis Report

## Original Query
```sql
SELECT sg.Name, eg.platform, SUM(ps.price) AS Total_Revenue
    FROM steam_games sg
    JOIN player_sales ps ON sg.id = ps.gameid
    JOIN epic_games eg ON sg.id = eg.game_id
    GROUP BY sg.Name, eg.platform;
```

## Query Analysis

### Query Type
SELECT (Read Operation)

### Tables Involved
[{'name': 'steam_games', 'alias': 'sg'}, {'name': 'player_sales', 'alias': 'ps'}, {'name': 'epic_games', 'alias': 'eg'}]

### Selected Columns
['sg.Name', 'eg.platform', 'SUM(ps.price) AS Total_Revenue']

### Aggregations
['SUM']

### Joins
[{'type': 'JOIN', 'condition': 'SG.ID = PS.GAMEID'}, {'type': 'JOIN', 'condition': 'SG.ID = EG.GAME_ID'}]

### Grouping
sg.Name, eg.platform

### Having
None

### Ordering
None

### Performance Tips
['Consider indexing the JOIN columns for better performance', 'Ensure proper indexing on GROUP BY columns', 'Aggregations detected. Ensure proper indexing for grouped columns']

## Subqueries and Results Preview

### steam_games
#### Subquery:
```sql
SELECT name, id
FROM steam_games
```

#### Results Preview:
| name | id |
| --- | --- |
| The Polynesian Cultural Center VR Experience | 9ebd6df06c5d449ebcef40c290a6d92d |
| Kingdom Defense | 84ec365b1deb472c94b61e62124b5fde |
| Immersion | 3f45fb583d8e43bcb7b5ea0fecde3427 |
| Remind Yourself | bab4fd658de14d24813ce02a09d971fa |
| Arcade Drift | a26b675b436f4f37acdd2a613970b531 |
| HyperDot | a04f4cd3ea004bed9c822f5a4b6451aa |
| Q*bert: Rebooted | d5aa82551cc44fdd94f3910f2b342d45 |
| My Dangerous Life | efde45643c17462496a0155013e001e8 |
| Pylon: Rogue | 40ea983191b04cf7a5f30004ad4ba953 |
| My Stepsis is a Futanari | e1c5bb84110e40f0834521aec80572d3 |

*Showing 10 of 83560 results*


### player_sales
#### Subquery:
```sql
SELECT SUM(price) AS Total_Revenue, gameid
FROM player_sales
GROUP BY gameid
```

#### Results Preview:
| total_revenue | gameid |
| --- | --- |
| 0.0 | 000076465cc14c32a909c9f3f4150dba |
| 75.61999999999998 | 0000792d6c8745e09c9d50158db6d4d3 |
| 134.55000000000004 | 0000bb19399445668482368864bddec2 |
| 968.4900000000001 | 0001bb515bf34444a5121e1292a1feea |
| 375.53 | 00024c9a1bfb4c23b7e1aca049825fdd |
| 206.54000000000005 | 00033fcc86bd4405a7eece08f0756923 |
| 82.68 | 0003742370a54739aeb0015453a86e4d |
| 0.0 | 00052deca7a14380803c297c9b6da1ba |
| 173.84000000000003 | 0005c900a7ab491fad8a5397696d7740 |
| 175.56000000000003 | 00070738e316494ebeab0a4cf2860685 |

*Showing 10 of 83746 results*


### epic_games
#### Subquery:
```sql
SELECT platform, game_id
FROM epic_games
```

#### Results Preview:
| platform | game_id |
| --- | --- |
| Windows | 4c81547b81064acfb1902be7b06d6366 |
| Windows | 3fdbd69050ec4091a68481b397f0a5dd |
| Windows,Mac | 5f82cbea3fdd42e2b9b9dfe8439b96b3 |
| Mac,Windows | 497cdc35842e458ca10a1edae95ae181 |
| nan | 0dfa5a4398bb44c8b1ac34e5f248fab9 |
| Windows | 0f96082fc0b8475db86cba86c8b6a796 |
| Windows | 49bdb24baa564f8c92848abe14112436 |
| Windows | e6dfe28ad2644018aa29f67054ff0391 |
| Windows | 58f2e8dff4a84c5796ebcbdd5d10fe34 |
| Windows | a90dd6aacad84318aa8d81d87cad5063 |

*Showing 10 of 915 results*


## Generated Materialized View
```sql

-- Create Materialized View

-- Drop view if exists (optional)
-- DROP MATERIALIZED VIEW IF EXISTS sum_steam_games;

-- Create materialized view if it doesn't exist
CREATE MATERIALIZED VIEW IF NOT EXISTS sum_steam_games AS
SELECT sg.Name, eg.platform, SUM(ps.price) AS Total_Revenue
FROM (
    SELECT name, id
FROM steam_games
) sg

JOIN (
    SELECT SUM(price) AS Total_Revenue, gameid
FROM player_sales
GROUP BY gameid
) ps ON 
JOIN (
    SELECT platform, game_id
FROM epic_games
) eg ON 
GROUP BY sg.Name, eg.platform;


-- Refresh materialized view
REFRESH MATERIALIZED VIEW sum_steam_games;


```

## Usage Instructions
1. To create the materialized view, execute the CREATE MATERIALIZED VIEW statement
2. To refresh the data in the view, execute the REFRESH MATERIALIZED VIEW statement
3. To query the materialized view:
```sql
SELECT * FROM sum_steam_games;
```
